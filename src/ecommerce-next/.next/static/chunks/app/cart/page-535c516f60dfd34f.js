(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[565],{8065:function(e,t,s){Promise.resolve().then(s.bind(s,1030))},1030:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var r=s(7437),n=s(2265),a=s(7648),i=s(3145),l=s(521),o=s(8614),c=s(2449),d=s(6858),u=s(1047),h=s(9397),m=s(8930);let p=(0,s(9763).Z)("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);var x=s(2489),f=s(3947),g=s(4508);function y(){let{cart:e,loading:t,updateQuantity:s,removeItem:y,applyCoupon:v,removeCoupon:w}=(0,f.x)(),[j,b]=(0,n.useState)(""),[N,k]=(0,n.useState)(!1),[S,C]=(0,n.useState)(""),[E,I]=(0,n.useState)(new Set),M=async(e,t)=>{if(!(t<1)){I(t=>new Set(t).add(e));try{await s(e,t)}finally{I(t=>{let s=new Set(t);return s.delete(e),s})}}},Z=async e=>{I(t=>new Set(t).add(e));try{await y(e)}finally{I(t=>{let s=new Set(t);return s.delete(e),s})}},T=async e=>{if(e.preventDefault(),j.trim()){k(!0),C("");try{await v(j),b("")}catch(e){C(e instanceof Error?e.message:"Invalid code")}finally{k(!1)}}};return t||e&&0!==e.items.length?(0,r.jsx)("div",{className:"min-h-screen bg-primary pt-28",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 lg:px-8 py-8 lg:py-12",children:[(0,r.jsxs)("h1",{className:"font-display text-3xl md:text-4xl font-semibold text-white mb-8",children:["Cart (",(null==e?void 0:e.items.length)||0,")"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,r.jsx)("div",{className:"lg:col-span-2 space-y-4",children:t?[void 0,void 0,void 0].map((e,t)=>(0,r.jsxs)("div",{className:"bg-surface-card rounded-2xl p-4 animate-pulse flex gap-4",children:[(0,r.jsx)("div",{className:"w-24 h-24 bg-surface-raised rounded-lg"}),(0,r.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,r.jsx)("div",{className:"h-5 bg-surface-raised rounded w-3/4"}),(0,r.jsx)("div",{className:"h-4 bg-surface-raised rounded w-1/2"}),(0,r.jsx)("div",{className:"h-6 bg-surface-raised rounded w-24"})]})]},t)):(0,r.jsx)(o.M,{mode:"popLayout",children:null==e?void 0:e.items.map(e=>{var t,s,n,o,c,d;return(0,r.jsx)(l.E.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},className:"bg-surface-card rounded-2xl p-4 md:p-6 ".concat(E.has(e.id)?"opacity-60":""),children:(0,r.jsxs)("div",{className:"flex gap-4 md:gap-6",children:[(0,r.jsx)(a.default,{href:"/product/".concat((null===(t=e.product)||void 0===t?void 0:t.slug)||e.productId),className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"relative w-24 h-24 md:w-32 md:h-32 rounded-lg overflow-hidden bg-surface-raised",children:((null===(s=e.product)||void 0===s?void 0:s.mainImageUrl)||(null===(n=e.product)||void 0===n?void 0:n.imageUrl))&&(0,r.jsx)(i.default,{src:e.product.mainImageUrl||e.product.imageUrl||"",alt:(null===(o=e.product)||void 0===o?void 0:o.name)||"Product",fill:!0,className:"object-cover"})})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)(a.default,{href:"/product/".concat((null===(c=e.product)||void 0===c?void 0:c.slug)||e.productId),className:"font-medium text-white hover:text-gold transition-colors line-clamp-2",children:(null===(d=e.product)||void 0===d?void 0:d.name)||"Product"}),e.variant&&(0,r.jsxs)("p",{className:"text-sm text-text-secondary mt-1",children:["Variant: ",e.variant.name]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-4 mt-4",children:[(0,r.jsxs)("div",{className:"flex items-center border border-white/10 rounded-lg",children:[(0,r.jsx)("button",{onClick:()=>M(e.id,e.quantity-1),disabled:e.quantity<=1||E.has(e.id),className:"p-2 text-white hover:text-gold disabled:text-gray-600 transition-colors","aria-label":"Decrease quantity",children:(0,r.jsx)(u.Z,{className:"w-4 h-4"})}),(0,r.jsx)("span",{className:"w-10 text-center text-white",children:e.quantity}),(0,r.jsx)("button",{onClick:()=>M(e.id,e.quantity+1),disabled:E.has(e.id),className:"p-2 text-white hover:text-gold disabled:text-gray-600 transition-colors","aria-label":"Increase quantity",children:(0,r.jsx)(h.Z,{className:"w-4 h-4"})})]}),(0,r.jsx)("button",{onClick:()=>Z(e.id),disabled:E.has(e.id),className:"text-text-secondary hover:text-error transition-colors","aria-label":"Remove item",children:(0,r.jsx)(m.Z,{className:"w-5 h-5"})})]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"font-semibold text-gold",children:(0,g.T4)(e.unitPrice*e.quantity)}),e.quantity>1&&(0,r.jsxs)("p",{className:"text-sm text-text-muted",children:[(0,g.T4)(e.unitPrice)," each"]})]})]})},e.id)})})}),(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsxs)("div",{className:"bg-surface-card rounded-2xl p-6 sticky top-24",children:[(0,r.jsx)("h2",{className:"font-display text-xl font-semibold text-white mb-6",children:"Order Summary"}),(0,r.jsxs)("form",{onSubmit:T,className:"mb-6",children:[(0,r.jsx)("label",{className:"text-sm text-text-secondary mb-2 block",children:"Discount Code"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",value:j,onChange:e=>b(e.target.value.toUpperCase()),placeholder:"CODICE",className:"flex-1 px-4 py-2 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50 uppercase"}),(0,r.jsx)("button",{type:"submit",disabled:N||!j.trim(),className:"btn-secondary btn-small",children:N?(0,r.jsx)("span",{className:"w-4 h-4 border-2 border-gold border-t-transparent rounded-full animate-spin"}):(0,r.jsx)(p,{className:"w-4 h-4"})})]}),S&&(0,r.jsx)("p",{className:"text-sm text-error mt-2",children:S})]}),(null==e?void 0:e.coupon)&&(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-success/10 rounded-lg mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(p,{className:"w-4 h-4 text-success"}),(0,r.jsx)("span",{className:"text-success font-medium",children:e.coupon.code})]}),(0,r.jsx)("button",{onClick:()=>w(),className:"text-text-muted hover:text-error transition-colors","aria-label":"Remove coupon",children:(0,r.jsx)(x.Z,{className:"w-4 h-4"})})]}),(0,r.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,r.jsxs)("div",{className:"flex justify-between text-text-secondary",children:[(0,r.jsx)("span",{children:"Subtotal"}),(0,r.jsx)("span",{children:(0,g.T4)((null==e?void 0:e.subtotal)||0)})]}),(null==e?void 0:e.discount)&&e.discount>0&&(0,r.jsxs)("div",{className:"flex justify-between text-success",children:[(0,r.jsx)("span",{children:"Discount"}),(0,r.jsxs)("span",{children:["-",(0,g.T4)(e.discount)]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-text-secondary",children:[(0,r.jsx)("span",{children:"Shipping"}),(0,r.jsx)("span",{children:(null==e?void 0:e.shipping)?(0,g.T4)(e.shipping):"Calculated at checkout"})]}),(0,r.jsxs)("div",{className:"pt-3 border-t border-white/10 flex justify-between text-white font-semibold text-lg",children:[(0,r.jsx)("span",{children:"Total"}),(0,r.jsx)("span",{className:"text-gold",children:(0,g.T4)((null==e?void 0:e.total)||0)})]})]}),(0,r.jsxs)(a.default,{href:"/checkout",className:"w-full btn-primary btn-large justify-center",children:["Proceed to Checkout",(0,r.jsx)(d.Z,{className:"w-5 h-5"})]}),(0,r.jsx)(a.default,{href:"/shop",className:"block text-center text-text-secondary hover:text-gold mt-4 text-sm transition-colors",children:"Continue Shopping"}),(0,r.jsxs)("div",{className:"mt-6 pt-6 border-t border-white/10",children:[(0,r.jsx)("p",{className:"text-xs text-text-muted text-center mb-3",children:"Accepted payment methods"}),(0,r.jsxs)("div",{className:"flex justify-center gap-2 opacity-50",children:[(0,r.jsx)("div",{className:"w-10 h-6 bg-white rounded"}),(0,r.jsx)("div",{className:"w-10 h-6 bg-white rounded"}),(0,r.jsx)("div",{className:"w-10 h-6 bg-white rounded"}),(0,r.jsx)("div",{className:"w-10 h-6 bg-white rounded"})]})]})]})})]})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-primary pt-28 flex items-center justify-center px-4",children:(0,r.jsxs)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center",children:[(0,r.jsx)("div",{className:"w-24 h-24 rounded-full bg-surface-card flex items-center justify-center mx-auto mb-6",children:(0,r.jsx)(c.Z,{className:"w-12 h-12 text-text-muted"})}),(0,r.jsx)("h1",{className:"font-display text-3xl font-semibold text-white mb-4",children:"Your cart is empty"}),(0,r.jsx)("p",{className:"text-text-secondary mb-8 max-w-md",children:"You haven't added any products to your cart yet. Browse our shop to find the perfect miniatures for you."}),(0,r.jsxs)(a.default,{href:"/shop",className:"btn-primary btn-large",children:["Start Shopping",(0,r.jsx)(d.Z,{className:"w-5 h-5"})]})]})})}},9116:function(e,t,s){"use strict";function r(e){localStorage.setItem("cart_session_id",e)}async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{params:s,headers:r,...n}=t,a=e.startsWith("http")?e:"".concat("http://localhost:3000/api/v1").concat(e);if(s){let e=new URLSearchParams;Object.entries(s).forEach(t=>{let[s,r]=t;null!=r&&e.append(s,String(r))});let t=e.toString();t&&(a+="?".concat(t))}let i={"Content-Type":"application/json",...r},l=localStorage.getItem("cart_session_id");l&&(i["X-Session-Id"]=l);let o=localStorage.getItem("auth_token");o&&(i.Authorization="Bearer ".concat(o));let c=await fetch(a,{...n,headers:i});if(!c.ok)throw Error((await c.json().catch(()=>({}))).error||"API Error: ".concat(c.status));let d=await c.json();if(!d.success&&d.error)throw Error(d.error);return d.data}s.d(t,{hi:function(){return a},xr:function(){return r}});let a={get:(e,t)=>n(e,{method:"GET",params:t}),post:(e,t)=>n(e,{method:"POST",body:t?JSON.stringify(t):void 0}),put:(e,t)=>n(e,{method:"PUT",body:t?JSON.stringify(t):void 0}),patch:(e,t)=>n(e,{method:"PATCH",body:t?JSON.stringify(t):void 0}),delete:e=>n(e,{method:"DELETE"})}},4508:function(e,t,s){"use strict";s.d(t,{$Q:function(){return l},Jn:function(){return c},Ox:function(){return o},T4:function(){return i},cn:function(){return a},p6:function(){return d}});var r=s(1994),n=s(3335);function a(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,n.m6)((0,r.W)(t))}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"EUR",s="string"==typeof e?parseFloat(e):e;return new Intl.NumberFormat("it-IT",{style:"currency",currency:t}).format(s)}function l(e,t){return e<=0||t>=e?0:Math.round((e-t)/e*100)}function o(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/images/placeholder.jpg";return e?"string"==typeof e?e:e.url||e.src||t:t}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{day:"numeric",month:"long",year:"numeric"},s="string"==typeof e?new Date(e):e;return new Intl.DateTimeFormat("it-IT",t).format(s)}},6858:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},1047:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},9397:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},2449:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]])},8930:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},2489:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},3947:function(e,t,s){"use strict";s.d(t,{x:function(){return l}});var r=s(9625),n=s(6885),a=s(9116),i=s(4508);let l=(0,r.Ue)()((0,n.tJ)((e,t)=>({cart:null,loading:!1,error:null,sessionId:null,isDrawerOpen:!1,initSession:()=>{let s=t().sessionId;s||e({sessionId:s=(0,i.Ox)()}),(0,a.xr)(s)},fetchCart:async()=>{e({loading:!0,error:null});try{t().initSession();let s=await a.hi.get("/shop/cart");e({cart:s,loading:!1})}catch(t){e({error:t.message,loading:!1})}},addItem:async(s,r,n)=>{e({loading:!0,error:null});try{t().initSession();let i=await a.hi.post("/shop/cart/items",{productId:s,quantity:r,variantId:n});e({cart:i,loading:!1,isDrawerOpen:!0})}catch(t){throw e({error:t.message,loading:!1}),t}},updateQuantity:async(t,s)=>{e({loading:!0,error:null});try{let r=await a.hi.patch("/shop/cart/items/".concat(t),{quantity:s});e({cart:r,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},removeItem:async t=>{e({loading:!0,error:null});try{let s=await a.hi.delete("/shop/cart/items/".concat(t));e({cart:s,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},clearCart:async()=>{e({loading:!0,error:null});try{await a.hi.delete("/shop/cart"),e({cart:null,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},applyCoupon:async t=>{e({loading:!0,error:null});try{let s=await a.hi.post("/shop/cart/coupon",{code:t});e({cart:s,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},removeCoupon:async()=>{e({loading:!0,error:null});try{let t=await a.hi.delete("/shop/cart/coupon");e({cart:t,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},setShippingAddress:async t=>{e({loading:!0,error:null});try{let s=await a.hi.put("/shop/cart/shipping-address",t);e({cart:s,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},setShippingMethod:async t=>{e({loading:!0,error:null});try{let s=await a.hi.put("/shop/cart/shipping-method",{methodId:t});e({cart:s,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},openDrawer:()=>e({isDrawerOpen:!0}),closeDrawer:()=>e({isDrawerOpen:!1}),toggleDrawer:()=>e(e=>({isDrawerOpen:!e.isDrawerOpen})),itemCount:()=>{let e=t().cart;return(null==e?void 0:e.items)?e.items.reduce((e,t)=>e+t.quantity,0):0},subtotal:()=>{var e;let s=t().cart;return null!==(e=null==s?void 0:s.subtotal)&&void 0!==e?e:0},total:()=>{var e;let s=t().cart;return null!==(e=null==s?void 0:s.total)&&void 0!==e?e:0},isEmpty:()=>{let e=t().cart;return!(null==e?void 0:e.items)||0===e.items.length}}),{name:"cart-storage",partialize:e=>({sessionId:e.sessionId})}))},8614:function(e,t,s){"use strict";s.d(t,{M:function(){return g}});var r=s(7437),n=s(2265),a=s(8881),i=s(3576),l=s(4252),o=s(5750);class c extends n.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function d(e){let{children:t,isPresent:s}=e,a=(0,n.useId)(),i=(0,n.useRef)(null),l=(0,n.useRef)({width:0,height:0,top:0,left:0}),{nonce:d}=(0,n.useContext)(o._);return(0,n.useInsertionEffect)(()=>{let{width:e,height:t,top:r,left:n}=l.current;if(s||!i.current||!e||!t)return;i.current.dataset.motionPopId=a;let o=document.createElement("style");return d&&(o.nonce=d),document.head.appendChild(o),o.sheet&&o.sheet.insertRule('\n          [data-motion-pop-id="'.concat(a,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            top: ").concat(r,"px !important;\n            left: ").concat(n,"px !important;\n          }\n        ")),()=>{document.head.removeChild(o)}},[s]),(0,r.jsx)(c,{isPresent:s,childRef:i,sizeRef:l,children:n.cloneElement(t,{ref:i})})}let u=e=>{let{children:t,initial:s,isPresent:a,onExitComplete:o,custom:c,presenceAffectsLayout:u,mode:m}=e,p=(0,i.h)(h),x=(0,n.useId)(),f=(0,n.useCallback)(e=>{for(let t of(p.set(e,!0),p.values()))if(!t)return;o&&o()},[p,o]),g=(0,n.useMemo)(()=>({id:x,initial:s,isPresent:a,custom:c,onExitComplete:f,register:e=>(p.set(e,!1),()=>p.delete(e))}),u?[Math.random(),f]:[a,f]);return(0,n.useMemo)(()=>{p.forEach((e,t)=>p.set(t,!1))},[a]),n.useEffect(()=>{a||p.size||!o||o()},[a]),"popLayout"===m&&(t=(0,r.jsx)(d,{isPresent:a,children:t})),(0,r.jsx)(l.O.Provider,{value:g,children:t})};function h(){return new Map}var m=s(9637);let p=e=>e.key||"";function x(e){let t=[];return n.Children.forEach(e,e=>{(0,n.isValidElement)(e)&&t.push(e)}),t}var f=s(1534);let g=e=>{let{children:t,custom:s,initial:l=!0,onExitComplete:o,presenceAffectsLayout:c=!0,mode:d="sync",propagate:h=!1}=e,[g,y]=(0,m.oO)(h),v=(0,n.useMemo)(()=>x(t),[t]),w=h&&!g?[]:v.map(p),j=(0,n.useRef)(!0),b=(0,n.useRef)(v),N=(0,i.h)(()=>new Map),[k,S]=(0,n.useState)(v),[C,E]=(0,n.useState)(v);(0,f.L)(()=>{j.current=!1,b.current=v;for(let e=0;e<C.length;e++){let t=p(C[e]);w.includes(t)?N.delete(t):!0!==N.get(t)&&N.set(t,!1)}},[C,w.length,w.join("-")]);let I=[];if(v!==k){let e=[...v];for(let t=0;t<C.length;t++){let s=C[t],r=p(s);w.includes(r)||(e.splice(t,0,s),I.push(s))}"wait"===d&&I.length&&(e=I),E(x(e)),S(v);return}let{forceRender:M}=(0,n.useContext)(a.p);return(0,r.jsx)(r.Fragment,{children:C.map(e=>{let t=p(e),n=(!h||!!g)&&(v===C||w.includes(t));return(0,r.jsx)(u,{isPresent:n,initial:(!j.current||!!l)&&void 0,custom:n?void 0:s,presenceAffectsLayout:c,mode:d,onExitComplete:n?void 0:()=>{if(!N.has(t))return;N.set(t,!0);let e=!0;N.forEach(t=>{t||(e=!1)}),e&&(null==M||M(),E(b.current),h&&(null==y||y()),o&&o())},children:e},t)})})}}},function(e){e.O(0,[972,230,312,883,971,117,744],function(){return e(e.s=8065)}),_N_E=e.O()}]);