(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[314],{3641:function(e,t,r){Promise.resolve().then(r.bind(r,9606))},9606:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var a=r(7437),o=r(2265),n=r(9376),s=r(7648),l=r(521),c=r(2369),i=r(4794),u=r(8997),d=r(3774);let h=(0,r(9763).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var m=r(7692),g=r(8717);let f=[{href:"/account",label:"Dashboard",icon:c.Z,exact:!0},{href:"/account/orders",label:"Ordini",icon:i.Z},{href:"/account/wishlist",label:"Lista Desideri",icon:u.Z},{href:"/account/addresses",label:"Indirizzi",icon:d.Z},{href:"/account/profile",label:"Profilo",icon:h}];function p(e){let{children:t}=e,r=(0,n.useRouter)(),c=(0,n.usePathname)(),{isAuthenticated:i,loading:u,customer:d,logout:h}=(0,g.t)();if((0,o.useEffect)(()=>{u||i()||r.push("/account/login?redirect=".concat(encodeURIComponent(c)))},[i,u,r,c]),"/account/login"===c||"/account/register"===c)return(0,a.jsx)(a.Fragment,{children:t});if(u)return(0,a.jsx)("div",{className:"min-h-screen bg-primary flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-10 h-10 border-4 border-gold border-t-transparent rounded-full animate-spin"})});if(!i)return null;let p=async()=>{await h(),r.push("/")};return(0,a.jsx)("div",{className:"min-h-screen bg-primary",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 lg:px-8 py-8 lg:py-12",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"font-display text-3xl md:text-4xl font-semibold text-white",children:"Il Mio Account"}),(0,a.jsxs)("p",{className:"text-text-secondary mt-2",children:["Benvenuto, ",(null==d?void 0:d.firstName)||(null==d?void 0:d.email)]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,a.jsx)("aside",{className:"lg:col-span-1",children:(0,a.jsx)("nav",{className:"bg-surface-card rounded-2xl p-4 sticky top-24",children:(0,a.jsxs)("ul",{className:"space-y-1",children:[f.map(e=>{let t=e.icon,r=e.exact?c===e.href:c.startsWith(e.href);return(0,a.jsx)("li",{children:(0,a.jsxs)(s.default,{href:e.href,className:"flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ".concat(r?"bg-gold/10 text-gold":"text-text-secondary hover:bg-surface-raised hover:text-white"),children:[(0,a.jsx)(t,{className:"w-5 h-5"}),e.label]})},e.href)}),(0,a.jsx)("li",{className:"pt-4 mt-4 border-t border-white/10",children:(0,a.jsxs)("button",{onClick:p,className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-text-secondary hover:bg-error/10 hover:text-error transition-colors",children:[(0,a.jsx)(m.Z,{className:"w-5 h-5"}),"Esci"]})})]})})}),(0,a.jsx)("main",{className:"lg:col-span-3",children:(0,a.jsx)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:t},c)})]})]})})}},9116:function(e,t,r){"use strict";function a(e){localStorage.setItem("cart_session_id",e)}async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{params:r,headers:a,...o}=t,n=e.startsWith("http")?e:"".concat("http://localhost:3000/api/v1").concat(e);if(r){let e=new URLSearchParams;Object.entries(r).forEach(t=>{let[r,a]=t;null!=a&&e.append(r,String(a))});let t=e.toString();t&&(n+="?".concat(t))}let s={"Content-Type":"application/json",...a},l=localStorage.getItem("cart_session_id");l&&(s["X-Session-Id"]=l);let c=localStorage.getItem("auth_token");c&&(s.Authorization="Bearer ".concat(c));let i=await fetch(n,{...o,headers:s});if(!i.ok)throw Error((await i.json().catch(()=>({}))).error||"API Error: ".concat(i.status));let u=await i.json();if(!u.success&&u.error)throw Error(u.error);return u.data}r.d(t,{hi:function(){return n},xr:function(){return a}});let n={get:(e,t)=>o(e,{method:"GET",params:t}),post:(e,t)=>o(e,{method:"POST",body:t?JSON.stringify(t):void 0}),put:(e,t)=>o(e,{method:"PUT",body:t?JSON.stringify(t):void 0}),patch:(e,t)=>o(e,{method:"PATCH",body:t?JSON.stringify(t):void 0}),delete:e=>o(e,{method:"DELETE"})}},8997:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},7692:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},3774:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},4794:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},2369:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return o.a}});var a=r(2972),o=r.n(a)},9376:function(e,t,r){"use strict";var a=r(5475);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},8717:function(e,t,r){"use strict";r.d(t,{t:function(){return s}});var a=r(9625),o=r(6885),n=r(9116);let s=(0,a.Ue)()((0,o.tJ)((e,t)=>({customer:null,token:null,loading:!1,error:null,login:async(t,r)=>{e({loading:!0,error:null});try{let a=await n.hi.post("/shop/auth/login",{email:t,password:r});localStorage.setItem("auth_token",a.token),e({customer:a.customer,token:a.token,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},register:async t=>{e({loading:!0,error:null});try{let r=await n.hi.post("/shop/auth/register",t);localStorage.setItem("auth_token",r.token),e({customer:r.customer,token:r.token,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},logout:()=>{localStorage.removeItem("auth_token"),e({customer:null,token:null,error:null})},fetchProfile:async()=>{e({loading:!0,error:null});try{let t=await n.hi.get("/shop/auth/me");e({customer:t,loading:!1})}catch(r){t().logout(),e({error:r.message,loading:!1})}},updateProfile:async t=>{e({loading:!0,error:null});try{let r=await n.hi.patch("/shop/auth/profile",t);e({customer:r,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},forgotPassword:async t=>{e({loading:!0,error:null});try{await n.hi.post("/shop/auth/forgot-password",{email:t}),e({loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},resetPassword:async(t,r)=>{e({loading:!0,error:null});try{await n.hi.post("/shop/auth/reset-password",{token:t,password:r}),e({loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},isAuthenticated:()=>!!t().token&&!!t().customer,fullName:()=>{let e=t().customer;return e?"".concat(e.firstName||""," ").concat(e.lastName||"").trim():""}}),{name:"auth-storage",partialize:e=>({token:e.token,customer:e.customer}),onRehydrateStorage:()=>e=>{(null==e?void 0:e.token)&&localStorage.setItem("auth_token",e.token)}}))}},function(e){e.O(0,[972,230,883,971,117,744],function(){return e(e.s=3641)}),_N_E=e.O()}]);