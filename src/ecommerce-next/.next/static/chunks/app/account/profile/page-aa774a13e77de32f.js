(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[997],{9554:function(e,t,a){Promise.resolve().then(a.bind(a,8619))},8619:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var r=a(7437),s=a(2265),o=a(521),l=a(401),n=a(2252),i=a(2369),c=a(9345),d=a(3041);let u=(0,a(9763).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);var m=a(8717),h=a(9116);function p(){let{customer:e,fetchProfile:t}=(0,m.t)(),[a,p]=(0,s.useState)({firstName:"",lastName:"",email:"",phone:""}),[x,f]=(0,s.useState)(!1),[g,y]=(0,s.useState)(""),[b,N]=(0,s.useState)(!1);(0,s.useEffect)(()=>{e&&p({firstName:e.firstName||"",lastName:e.lastName||"",email:e.email||"",phone:e.phone||""})},[e]);let w=e=>{let{name:t,value:a}=e.target;p(e=>({...e,[t]:a})),y(""),N(!1)},j=async e=>{e.preventDefault(),f(!0),y(""),N(!1);try{if((await h.hi.put("/shop-auth/profile",a)).success)N(!0),t();else throw Error("Failed to update profile")}catch(e){y(e instanceof Error?e.message:"Impossibile aggiornare il profilo")}finally{f(!1)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("h2",{className:"font-display text-2xl font-semibold text-white",children:"Il Mio Profilo"}),(0,r.jsx)("div",{className:"bg-surface-card rounded-2xl p-6",children:(0,r.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[b&&(0,r.jsxs)(o.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-2 p-4 bg-success/10 border border-success/20 rounded-lg",children:[(0,r.jsx)(l.Z,{className:"w-5 h-5 text-success flex-shrink-0"}),(0,r.jsx)("p",{className:"text-sm text-success",children:"Profilo aggiornato con successo"})]}),g&&(0,r.jsxs)(o.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-2 p-4 bg-error/10 border border-error/20 rounded-lg",children:[(0,r.jsx)(n.Z,{className:"w-5 h-5 text-error flex-shrink-0"}),(0,r.jsx)("p",{className:"text-sm text-error",children:g})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"firstName",className:"block text-sm font-medium text-text-secondary mb-2",children:"Nome"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(i.Z,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-text-muted"}),(0,r.jsx)("input",{id:"firstName",name:"firstName",type:"text",value:a.firstName,onChange:w,className:"w-full pl-12 pr-4 py-3 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"lastName",className:"block text-sm font-medium text-text-secondary mb-2",children:"Cognome"}),(0,r.jsx)("input",{id:"lastName",name:"lastName",type:"text",value:a.lastName,onChange:w,className:"w-full px-4 py-3 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-text-secondary mb-2",children:"Email"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(c.Z,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-text-muted"}),(0,r.jsx)("input",{id:"email",name:"email",type:"email",value:a.email,onChange:w,className:"w-full pl-12 pr-4 py-3 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-text-secondary mb-2",children:"Telefono"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(d.Z,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-text-muted"}),(0,r.jsx)("input",{id:"phone",name:"phone",type:"tel",value:a.phone,onChange:w,placeholder:"+39 123 456 7890",className:"w-full pl-12 pr-4 py-3 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50"})]})]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)("button",{type:"submit",disabled:x,className:"btn-primary btn-large",children:x?(0,r.jsx)("span",{className:"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u,{className:"w-5 h-5"}),"Salva Modifiche"]})})})]})}),(0,r.jsxs)("div",{className:"bg-surface-card rounded-2xl p-6",children:[(0,r.jsx)("h3",{className:"font-display text-lg font-semibold text-white mb-4",children:"Cambia Password"}),(0,r.jsx)("p",{className:"text-text-secondary text-sm mb-4",children:"Per cambiare la tua password, ti invieremo un link via email."}),(0,r.jsx)("button",{className:"btn-secondary btn-medium",children:"Invia Link di Reset"})]}),(0,r.jsxs)("div",{className:"bg-surface-card rounded-2xl p-6 border border-error/20",children:[(0,r.jsx)("h3",{className:"font-display text-lg font-semibold text-white mb-4",children:"Elimina Account"}),(0,r.jsx)("p",{className:"text-text-secondary text-sm mb-4",children:"Una volta eliminato il tuo account, tutti i tuoi dati verranno rimossi permanentemente. Questa azione non puo essere annullata."}),(0,r.jsx)("button",{className:"btn-secondary btn-medium text-error border-error/30 hover:bg-error/10",children:"Elimina Account"})]})]})}},9116:function(e,t,a){"use strict";function r(e){localStorage.setItem("cart_session_id",e)}async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{params:a,headers:r,...s}=t,o=e.startsWith("http")?e:"".concat("http://localhost:3000/api/v1").concat(e);if(a){let e=new URLSearchParams;Object.entries(a).forEach(t=>{let[a,r]=t;null!=r&&e.append(a,String(r))});let t=e.toString();t&&(o+="?".concat(t))}let l={"Content-Type":"application/json",...r},n=localStorage.getItem("cart_session_id");n&&(l["X-Session-Id"]=n);let i=localStorage.getItem("auth_token");i&&(l.Authorization="Bearer ".concat(i));let c=await fetch(o,{...s,headers:l});if(!c.ok)throw Error((await c.json().catch(()=>({}))).error||"API Error: ".concat(c.status));let d=await c.json();if(!d.success&&d.error)throw Error(d.error);return d.data}a.d(t,{hi:function(){return o},xr:function(){return r}});let o={get:(e,t)=>s(e,{method:"GET",params:t}),post:(e,t)=>s(e,{method:"POST",body:t?JSON.stringify(t):void 0}),put:(e,t)=>s(e,{method:"PUT",body:t?JSON.stringify(t):void 0}),patch:(e,t)=>s(e,{method:"PATCH",body:t?JSON.stringify(t):void 0}),delete:e=>s(e,{method:"DELETE"})}},2252:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},401:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},9345:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},3041:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},2369:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},8717:function(e,t,a){"use strict";a.d(t,{t:function(){return l}});var r=a(9625),s=a(6885),o=a(9116);let l=(0,r.Ue)()((0,s.tJ)((e,t)=>({customer:null,token:null,loading:!1,error:null,login:async(t,a)=>{e({loading:!0,error:null});try{let r=await o.hi.post("/shop/auth/login",{email:t,password:a});localStorage.setItem("auth_token",r.token),e({customer:r.customer,token:r.token,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},register:async t=>{e({loading:!0,error:null});try{let a=await o.hi.post("/shop/auth/register",t);localStorage.setItem("auth_token",a.token),e({customer:a.customer,token:a.token,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},logout:()=>{localStorage.removeItem("auth_token"),e({customer:null,token:null,error:null})},fetchProfile:async()=>{e({loading:!0,error:null});try{let t=await o.hi.get("/shop/auth/me");e({customer:t,loading:!1})}catch(a){t().logout(),e({error:a.message,loading:!1})}},updateProfile:async t=>{e({loading:!0,error:null});try{let a=await o.hi.patch("/shop/auth/profile",t);e({customer:a,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},forgotPassword:async t=>{e({loading:!0,error:null});try{await o.hi.post("/shop/auth/forgot-password",{email:t}),e({loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},resetPassword:async(t,a)=>{e({loading:!0,error:null});try{await o.hi.post("/shop/auth/reset-password",{token:t,password:a}),e({loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},isAuthenticated:()=>!!t().token&&!!t().customer,fullName:()=>{let e=t().customer;return e?"".concat(e.firstName||""," ").concat(e.lastName||"").trim():""}}),{name:"auth-storage",partialize:e=>({token:e.token,customer:e.customer}),onRehydrateStorage:()=>e=>{(null==e?void 0:e.token)&&localStorage.setItem("auth_token",e.token)}}))}},function(e){e.O(0,[230,883,971,117,744],function(){return e(e.s=9554)}),_N_E=e.O()}]);