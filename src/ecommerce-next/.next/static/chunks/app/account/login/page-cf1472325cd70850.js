(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[326],{6271:function(e,t,r){Promise.resolve().then(r.bind(r,361))},361:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var a=r(7437),s=r(2265),o=r(9376),n=r(7648),l=r(521),c=r(2252),i=r(9345),u=r(6337),d=r(7769),h=r(2208),m=r(8717);function x(){let e=(0,o.useRouter)(),t=(0,o.useSearchParams)().get("redirect")||"/account",{login:r,loading:x,error:p}=(0,m.t)(),[f,g]=(0,s.useState)(""),[y,w]=(0,s.useState)(""),[j,b]=(0,s.useState)(!1),N=async a=>{a.preventDefault();try{await r(f,y),e.push(t)}catch(e){}};return(0,a.jsx)("div",{className:"min-h-screen bg-primary flex items-center justify-center px-4",children:(0,a.jsxs)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-md",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)(n.default,{href:"/",className:"inline-block",children:(0,a.jsxs)("h1",{className:"font-display text-3xl font-bold text-gold",children:["ECOMMERCE",(0,a.jsx)("span",{className:"text-white",children:"ERP"})]})}),(0,a.jsx)("p",{className:"text-text-secondary mt-4",children:"Accedi al tuo account"})]}),(0,a.jsxs)("div",{className:"bg-surface-card rounded-2xl p-8",children:[(0,a.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[p&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-4 bg-error/10 border border-error/20 rounded-lg",children:[(0,a.jsx)(c.Z,{className:"w-5 h-5 text-error flex-shrink-0"}),(0,a.jsx)("p",{className:"text-sm text-error",children:p})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-text-secondary mb-2",children:"Email"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(i.Z,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-text-muted"}),(0,a.jsx)("input",{id:"email",type:"email",value:f,onChange:e=>g(e.target.value),required:!0,autoComplete:"email",className:"w-full pl-12 pr-4 py-3 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50",placeholder:"email@esempio.com"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-text-secondary mb-2",children:"Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(u.Z,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-text-muted"}),(0,a.jsx)("input",{id:"password",type:j?"text":"password",value:y,onChange:e=>w(e.target.value),required:!0,autoComplete:"current-password",className:"w-full pl-12 pr-12 py-3 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50",placeholder:"La tua password"}),(0,a.jsx)("button",{type:"button",onClick:()=>b(!j),className:"absolute right-4 top-1/2 -translate-y-1/2 text-text-muted hover:text-white transition-colors","aria-label":j?"Hide password":"Show password",children:j?(0,a.jsx)(d.Z,{className:"w-5 h-5"}):(0,a.jsx)(h.Z,{className:"w-5 h-5"})})]})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsx)(n.default,{href:"/account/forgot-password",className:"text-sm text-gold hover:underline",children:"Password dimenticata?"})}),(0,a.jsx)("button",{type:"submit",disabled:x,className:"w-full btn-primary btn-large justify-center",children:x?(0,a.jsx)("span",{className:"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin"}):"Accedi"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 my-6",children:[(0,a.jsx)("div",{className:"flex-1 h-px bg-white/10"}),(0,a.jsx)("span",{className:"text-text-muted text-sm",children:"oppure"}),(0,a.jsx)("div",{className:"flex-1 h-px bg-white/10"})]}),(0,a.jsxs)("p",{className:"text-center text-text-secondary",children:["Non hai un account?"," ",(0,a.jsx)(n.default,{href:"/account/register".concat("/account"!==t?"?redirect=".concat(encodeURIComponent(t)):""),className:"text-gold hover:underline",children:"Registrati"})]})]}),(0,a.jsx)("p",{className:"text-center mt-6",children:(0,a.jsx)(n.default,{href:"/",className:"text-text-muted hover:text-white transition-colors",children:"Torna alla Home"})})]})})}function p(){return(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen bg-primary flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-10 h-10 border-4 border-gold border-t-transparent rounded-full animate-spin"})}),children:(0,a.jsx)(x,{})})}},9116:function(e,t,r){"use strict";function a(e){localStorage.setItem("cart_session_id",e)}async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{params:r,headers:a,...s}=t,o=e.startsWith("http")?e:"".concat("http://localhost:3000/api/v1").concat(e);if(r){let e=new URLSearchParams;Object.entries(r).forEach(t=>{let[r,a]=t;null!=a&&e.append(r,String(a))});let t=e.toString();t&&(o+="?".concat(t))}let n={"Content-Type":"application/json",...a},l=localStorage.getItem("cart_session_id");l&&(n["X-Session-Id"]=l);let c=localStorage.getItem("auth_token");c&&(n.Authorization="Bearer ".concat(c));let i=await fetch(o,{...s,headers:n});if(!i.ok)throw Error((await i.json().catch(()=>({}))).error||"API Error: ".concat(i.status));let u=await i.json();if(!u.success&&u.error)throw Error(u.error);return u.data}r.d(t,{hi:function(){return o},xr:function(){return a}});let o={get:(e,t)=>s(e,{method:"GET",params:t}),post:(e,t)=>s(e,{method:"POST",body:t?JSON.stringify(t):void 0}),put:(e,t)=>s(e,{method:"PUT",body:t?JSON.stringify(t):void 0}),patch:(e,t)=>s(e,{method:"PATCH",body:t?JSON.stringify(t):void 0}),delete:e=>s(e,{method:"DELETE"})}},2252:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},7769:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},2208:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},6337:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},9345:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return s.a}});var a=r(2972),s=r.n(a)},9376:function(e,t,r){"use strict";var a=r(5475);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},8717:function(e,t,r){"use strict";r.d(t,{t:function(){return n}});var a=r(9625),s=r(6885),o=r(9116);let n=(0,a.Ue)()((0,s.tJ)((e,t)=>({customer:null,token:null,loading:!1,error:null,login:async(t,r)=>{e({loading:!0,error:null});try{let a=await o.hi.post("/shop/auth/login",{email:t,password:r});localStorage.setItem("auth_token",a.token),e({customer:a.customer,token:a.token,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},register:async t=>{e({loading:!0,error:null});try{let r=await o.hi.post("/shop/auth/register",t);localStorage.setItem("auth_token",r.token),e({customer:r.customer,token:r.token,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},logout:()=>{localStorage.removeItem("auth_token"),e({customer:null,token:null,error:null})},fetchProfile:async()=>{e({loading:!0,error:null});try{let t=await o.hi.get("/shop/auth/me");e({customer:t,loading:!1})}catch(r){t().logout(),e({error:r.message,loading:!1})}},updateProfile:async t=>{e({loading:!0,error:null});try{let r=await o.hi.patch("/shop/auth/profile",t);e({customer:r,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},forgotPassword:async t=>{e({loading:!0,error:null});try{await o.hi.post("/shop/auth/forgot-password",{email:t}),e({loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},resetPassword:async(t,r)=>{e({loading:!0,error:null});try{await o.hi.post("/shop/auth/reset-password",{token:t,password:r}),e({loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},isAuthenticated:()=>!!t().token&&!!t().customer,fullName:()=>{let e=t().customer;return e?"".concat(e.firstName||""," ").concat(e.lastName||"").trim():""}}),{name:"auth-storage",partialize:e=>({token:e.token,customer:e.customer}),onRehydrateStorage:()=>e=>{(null==e?void 0:e.token)&&localStorage.setItem("auth_token",e.token)}}))}},function(e){e.O(0,[972,230,883,971,117,744],function(){return e(e.s=6271)}),_N_E=e.O()}]);