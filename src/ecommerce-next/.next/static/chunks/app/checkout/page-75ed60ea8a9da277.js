(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[285],{4825:function(e,t,s){Promise.resolve().then(s.bind(s,4370))},4370:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return w}});var a=s(7437),n=s(2265),r=s(9376),i=s(7648),o=s(3145),l=s(8614),d=s(521),c=s(2369),u=s(340);let m=(0,s(9763).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);var h=s(2451),p=s(6337),x=s(401),g=s(407),f=s(3947),y=s(8717),b=s(9116),j=s(4508);let v=[{key:"info",label:"Informazioni",icon:c.Z},{key:"shipping",label:"Spedizione",icon:u.Z},{key:"payment",label:"Pagamento",icon:m}];function w(){let e=(0,r.useRouter)(),{cart:t,loading:s,clearCart:c}=(0,f.x)(),{customer:u}=(0,y.t)(),{methods:w,loading:N}=function(){let[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!0),[r,i]=(0,n.useState)(null);return(0,n.useEffect)(()=>{(async()=>{try{let e=await b.hi.get("/shop/shipping/methods");e.success&&e.data&&t(e.data)}catch(e){i(e instanceof Error?e.message:"Failed to fetch shipping methods")}finally{a(!1)}})()},[]),{methods:e,loading:s,error:r}}(),{countries:k}=function(){let[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!0),[r,i]=(0,n.useState)(null);return(0,n.useEffect)(()=>{(async()=>{try{let e=await b.hi.get("/shop/shipping/countries");e.success&&e.data&&t(e.data)}catch(e){t([{code:"IT",name:"Italia"},{code:"DE",name:"Germania"},{code:"FR",name:"Francia"},{code:"ES",name:"Spagna"},{code:"GB",name:"Regno Unito"},{code:"US",name:"Stati Uniti"}])}finally{a(!1)}})()},[]),{countries:e,loading:s,error:r}}(),[C,S]=(0,n.useState)("info"),[I,M]=(0,n.useState)(!1),[P,E]=(0,n.useState)(""),[z,D]=(0,n.useState)({email:(null==u?void 0:u.email)||"",phone:"",firstName:"",lastName:"",company:"",address:"",addressLine2:"",city:"",province:"",postalCode:"",country:"IT",billingDifferent:!1,billingFirstName:"",billingLastName:"",billingCompany:"",billingAddress:"",billingAddressLine2:"",billingCity:"",billingProvince:"",billingPostalCode:"",billingCountry:"IT",shippingMethodId:"",paymentMethod:"stripe",savePaymentInfo:!1,notes:""});(0,n.useEffect)(()=>{(null==u?void 0:u.email)&&D(e=>({...e,email:u.email}))},[u]),(0,n.useEffect)(()=>{s||t&&0!==t.items.length||e.push("/cart")},[t,s,e]);let T=e=>{let{name:t,value:s,type:a}=e.target,n=e.target.checked;D(e=>({...e,[t]:"checkbox"===a?n:s}))},Z=()=>{let e=v.findIndex(e=>e.key===C);e<v.length-1&&S(v[e+1].key)},R=()=>{let e=v.findIndex(e=>e.key===C);e>0&&S(v[e-1].key)},O=e=>{switch(e){case"info":return!!(z.email&&z.firstName&&z.lastName&&z.address&&z.city&&z.postalCode&&z.country);case"shipping":return!!z.shippingMethodId;case"payment":return!!z.paymentMethod;default:return!1}},_=async()=>{if(O("payment")){M(!0),E("");try{let t={contact:{email:z.email,phone:z.phone},shippingAddress:{firstName:z.firstName,lastName:z.lastName,company:z.company,address:z.address,addressLine2:z.addressLine2,city:z.city,province:z.province,postalCode:z.postalCode,country:z.country},billingAddress:z.billingDifferent?{firstName:z.billingFirstName,lastName:z.billingLastName,company:z.billingCompany,address:z.billingAddress,addressLine2:z.billingAddressLine2,city:z.billingCity,province:z.billingProvince,postalCode:z.billingPostalCode,country:z.billingCountry}:null,shippingMethodId:z.shippingMethodId,paymentMethod:z.paymentMethod,notes:z.notes},s=await b.hi.post("/shop/checkout",t);if(s.success&&s.data)s.data.paymentUrl?window.location.href=s.data.paymentUrl:(c(),e.push("/checkout/confirmation?orderId=".concat(s.data.orderId)));else throw Error("Failed to create order")}catch(e){E(e instanceof Error?e.message:"Si e verificato un errore")}finally{M(!1)}}},L=w.find(e=>e.id===z.shippingMethodId);return s?(0,a.jsx)("div",{className:"min-h-screen bg-primary flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-10 h-10 border-4 border-gold border-t-transparent rounded-full animate-spin"})}):(0,a.jsx)("div",{className:"min-h-screen bg-primary",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)(i.default,{href:"/cart",className:"flex items-center gap-2 text-text-secondary hover:text-white transition-colors",children:[(0,a.jsx)(h.Z,{className:"w-5 h-5"}),"Torna al Carrello"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gold",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-sm",children:"Checkout Sicuro"})]})]}),(0,a.jsx)("div",{className:"flex items-center justify-center gap-4 md:gap-8 mb-12",children:v.map((e,t)=>{let s=e.key===C,n=v.findIndex(e=>e.key===C)>t,r=e.icon;return(0,a.jsxs)("div",{className:"flex items-center gap-2 md:gap-4",children:[(0,a.jsxs)("button",{onClick:()=>n&&S(e.key),disabled:!n,className:"flex items-center gap-2 ".concat(s?"text-gold":n?"text-success cursor-pointer":"text-text-muted cursor-not-allowed"),children:[(0,a.jsx)("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-full flex items-center justify-center ".concat(s?"bg-gold text-primary":n?"bg-success text-white":"bg-surface-card text-text-muted"),children:n?(0,a.jsx)(x.Z,{className:"w-4 h-4"}):(0,a.jsx)(r,{className:"w-4 h-4"})}),(0,a.jsx)("span",{className:"hidden md:block font-medium",children:e.label})]}),t<v.length-1&&(0,a.jsx)("div",{className:"w-8 md:w-16 h-0.5 ".concat(n?"bg-success":"bg-surface-card")})]},e.key)})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsxs)(l.M,{mode:"wait",children:["info"===C&&(0,a.jsxs)(d.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-8",children:[(0,a.jsxs)("div",{className:"bg-surface-card rounded-2xl p-6",children:[(0,a.jsx)("h2",{className:"font-display text-xl font-semibold text-white mb-6",children:"Informazioni di Contatto"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Email *"}),(0,a.jsx)("input",{type:"email",name:"email",value:z.email,onChange:T,required:!0,className:"w-full px-4 py-3 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Telefono"}),(0,a.jsx)("input",{type:"tel",name:"phone",value:z.phone,onChange:T,className:"w-full px-4 py-3 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50"})]})]})]}),(0,a.jsxs)("div",{className:"bg-surface-card rounded-2xl p-6",children:[(0,a.jsx)("h2",{className:"font-display text-xl font-semibold text-white mb-6",children:"Indirizzo di Spedizione"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Nome *"}),(0,a.jsx)("input",{type:"text",name:"firstName",value:z.firstName,onChange:T,required:!0,className:"w-full px-4 py-3 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Cognome *"}),(0,a.jsx)("input",{type:"text",name:"lastName",value:z.lastName,onChange:T,required:!0,className:"w-full px-4 py-3 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Azienda (opzionale)"}),(0,a.jsx)("input",{type:"text",name:"company",value:z.company,onChange:T,className:"w-full px-4 py-3 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Indirizzo *"}),(0,a.jsx)("input",{type:"text",name:"address",value:z.address,onChange:T,required:!0,className:"w-full px-4 py-3 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Appartamento, interno, etc. (opzionale)"}),(0,a.jsx)("input",{type:"text",name:"addressLine2",value:z.addressLine2,onChange:T,className:"w-full px-4 py-3 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Citta *"}),(0,a.jsx)("input",{type:"text",name:"city",value:z.city,onChange:T,required:!0,className:"w-full px-4 py-3 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Provincia"}),(0,a.jsx)("input",{type:"text",name:"province",value:z.province,onChange:T,className:"w-full px-4 py-3 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"CAP *"}),(0,a.jsx)("input",{type:"text",name:"postalCode",value:z.postalCode,onChange:T,required:!0,className:"w-full px-4 py-3 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Paese *"}),(0,a.jsx)("select",{name:"country",value:z.country,onChange:T,required:!0,className:"w-full px-4 py-3 bg-surface-raised border border-white/10 rounded-lg text-white focus:outline-none focus:border-gold/50",children:k.map(e=>(0,a.jsx)("option",{value:e.code,children:e.name},e.code))})]})]}),(0,a.jsxs)("label",{className:"flex items-center gap-3 mt-6 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",name:"billingDifferent",checked:z.billingDifferent,onChange:T,className:"w-5 h-5 rounded border-white/20 bg-surface-raised text-gold focus:ring-gold/50"}),(0,a.jsx)("span",{className:"text-text-secondary",children:"Usa un indirizzo di fatturazione diverso"})]})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)("button",{onClick:Z,disabled:!O("info"),className:"btn-primary btn-large",children:["Continua",(0,a.jsx)(g.Z,{className:"w-5 h-5"})]})})]},"info"),"shipping"===C&&(0,a.jsxs)(d.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-8",children:[(0,a.jsxs)("div",{className:"bg-surface-card rounded-2xl p-6",children:[(0,a.jsx)("h2",{className:"font-display text-xl font-semibold text-white mb-6",children:"Metodo di Spedizione"}),N?(0,a.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"h-20 bg-surface-raised rounded-lg animate-pulse"},t))}):(0,a.jsx)("div",{className:"space-y-3",children:w.map(e=>(0,a.jsxs)("label",{className:"flex items-center justify-between p-4 rounded-lg border cursor-pointer transition-all ".concat(z.shippingMethodId===e.id?"border-gold bg-gold/10":"border-white/10 hover:border-gold/50"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("input",{type:"radio",name:"shippingMethodId",value:e.id,checked:z.shippingMethodId===e.id,onChange:T,className:"w-5 h-5 text-gold focus:ring-gold/50"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-white",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-text-secondary",children:e.estimatedDaysMin===e.estimatedDaysMax?"".concat(e.estimatedDaysMin," giorni lavorativi"):"".concat(e.estimatedDaysMin,"-").concat(e.estimatedDaysMax," giorni lavorativi")})]})]}),(0,a.jsx)("span",{className:"font-semibold text-gold",children:0===e.baseCost?"Gratis":(0,j.T4)(e.baseCost)})]},e.id))})]}),(0,a.jsxs)("div",{className:"bg-surface-card rounded-2xl p-6",children:[(0,a.jsx)("h2",{className:"font-display text-xl font-semibold text-white mb-6",children:"Note (opzionale)"}),(0,a.jsx)("textarea",{name:"notes",value:z.notes,onChange:T,placeholder:"Istruzioni speciali per la consegna...",rows:3,className:"w-full px-4 py-3 bg-surface-raised border border-white/10 rounded-lg text-white placeholder-text-muted focus:outline-none focus:border-gold/50 resize-none"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("button",{onClick:R,className:"btn-secondary btn-large",children:[(0,a.jsx)(h.Z,{className:"w-5 h-5"}),"Indietro"]}),(0,a.jsxs)("button",{onClick:Z,disabled:!O("shipping"),className:"btn-primary btn-large",children:["Continua",(0,a.jsx)(g.Z,{className:"w-5 h-5"})]})]})]},"shipping"),"payment"===C&&(0,a.jsxs)(d.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-8",children:[(0,a.jsxs)("div",{className:"bg-surface-card rounded-2xl p-6",children:[(0,a.jsx)("h2",{className:"font-display text-xl font-semibold text-white mb-6",children:"Metodo di Pagamento"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("label",{className:"flex items-center justify-between p-4 rounded-lg border cursor-pointer transition-all ".concat("stripe"===z.paymentMethod?"border-gold bg-gold/10":"border-white/10 hover:border-gold/50"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("input",{type:"radio",name:"paymentMethod",value:"stripe",checked:"stripe"===z.paymentMethod,onChange:T,className:"w-5 h-5 text-gold focus:ring-gold/50"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-white",children:"Carta di Credito / Debito"}),(0,a.jsx)("p",{className:"text-sm text-text-secondary",children:"Visa, Mastercard, American Express"})]})]}),(0,a.jsx)(m,{className:"w-6 h-6 text-text-muted"})]}),(0,a.jsxs)("label",{className:"flex items-center justify-between p-4 rounded-lg border cursor-pointer transition-all ".concat("paypal"===z.paymentMethod?"border-gold bg-gold/10":"border-white/10 hover:border-gold/50"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("input",{type:"radio",name:"paymentMethod",value:"paypal",checked:"paypal"===z.paymentMethod,onChange:T,className:"w-5 h-5 text-gold focus:ring-gold/50"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-white",children:"PayPal"}),(0,a.jsx)("p",{className:"text-sm text-text-secondary",children:"Paga con il tuo account PayPal"})]})]}),(0,a.jsx)("div",{className:"w-16 h-6 bg-white rounded flex items-center justify-center text-xs font-bold text-blue-600",children:"PayPal"})]}),(0,a.jsx)("label",{className:"flex items-center justify-between p-4 rounded-lg border cursor-pointer transition-all ".concat("bank_transfer"===z.paymentMethod?"border-gold bg-gold/10":"border-white/10 hover:border-gold/50"),children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("input",{type:"radio",name:"paymentMethod",value:"bank_transfer",checked:"bank_transfer"===z.paymentMethod,onChange:T,className:"w-5 h-5 text-gold focus:ring-gold/50"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-white",children:"Bonifico Bancario"}),(0,a.jsx)("p",{className:"text-sm text-text-secondary",children:"Riceverai i dati via email"})]})]})})]})]}),P&&(0,a.jsx)("div",{className:"p-4 bg-error/10 border border-error/20 rounded-lg",children:(0,a.jsx)("p",{className:"text-error",children:P})}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("button",{onClick:R,className:"btn-secondary btn-large",children:[(0,a.jsx)(h.Z,{className:"w-5 h-5"}),"Indietro"]}),(0,a.jsx)("button",{onClick:_,disabled:!O("payment")||I,className:"btn-primary btn-large",children:I?(0,a.jsx)("span",{className:"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin"}):(0,a.jsxs)(a.Fragment,{children:["Completa Ordine",(0,a.jsx)(x.Z,{className:"w-5 h-5"})]})})]})]},"payment")]})}),(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"bg-surface-card rounded-2xl p-6 sticky top-24",children:[(0,a.jsx)("h2",{className:"font-display text-xl font-semibold text-white mb-6",children:"Riepilogo Ordine"}),(0,a.jsx)("div",{className:"space-y-4 max-h-64 overflow-y-auto mb-6",children:null==t?void 0:t.items.map(e=>{var t,s,n;return(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-surface-raised flex-shrink-0",children:[(null===(t=e.product)||void 0===t?void 0:t.imageUrl)&&(0,a.jsx)(o.default,{src:e.product.imageUrl,alt:(null===(s=e.product)||void 0===s?void 0:s.name)||"Product",fill:!0,className:"object-cover"}),(0,a.jsx)("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-gold text-primary text-xs font-bold rounded-full flex items-center justify-center",children:e.quantity})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm text-white truncate",children:null===(n=e.product)||void 0===n?void 0:n.name}),e.variant&&(0,a.jsx)("p",{className:"text-xs text-text-muted",children:e.variant.name})]}),(0,a.jsx)("p",{className:"text-sm font-medium text-gold",children:(0,j.T4)(e.unitPrice*e.quantity)})]},e.id)})}),(0,a.jsxs)("div",{className:"space-y-3 pt-4 border-t border-white/10",children:[(0,a.jsxs)("div",{className:"flex justify-between text-text-secondary",children:[(0,a.jsx)("span",{children:"Subtotale"}),(0,a.jsx)("span",{children:(0,j.T4)((null==t?void 0:t.subtotal)||0)})]}),(null==t?void 0:t.discount)&&t.discount>0&&(0,a.jsxs)("div",{className:"flex justify-between text-success",children:[(0,a.jsx)("span",{children:"Sconto"}),(0,a.jsxs)("span",{children:["-",(0,j.T4)(t.discount)]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-text-secondary",children:[(0,a.jsx)("span",{children:"Spedizione"}),(0,a.jsx)("span",{children:L?0===L.baseCost?"Gratis":(0,j.T4)(L.baseCost):"-"})]}),(0,a.jsxs)("div",{className:"pt-3 border-t border-white/10 flex justify-between text-white font-semibold text-lg",children:[(0,a.jsx)("span",{children:"Totale"}),(0,a.jsx)("span",{className:"text-gold",children:(0,j.T4)(((null==t?void 0:t.subtotal)||0)-((null==t?void 0:t.discount)||0)+((null==L?void 0:L.baseCost)||0))})]})]})]})})]})]})})}},9116:function(e,t,s){"use strict";function a(e){localStorage.setItem("cart_session_id",e)}async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{params:s,headers:a,...n}=t,r=e.startsWith("http")?e:"".concat("http://localhost:3000/api/v1").concat(e);if(s){let e=new URLSearchParams;Object.entries(s).forEach(t=>{let[s,a]=t;null!=a&&e.append(s,String(a))});let t=e.toString();t&&(r+="?".concat(t))}let i={"Content-Type":"application/json",...a},o=localStorage.getItem("cart_session_id");o&&(i["X-Session-Id"]=o);let l=localStorage.getItem("auth_token");l&&(i.Authorization="Bearer ".concat(l));let d=await fetch(r,{...n,headers:i});if(!d.ok)throw Error((await d.json().catch(()=>({}))).error||"API Error: ".concat(d.status));let c=await d.json();if(!c.success&&c.error)throw Error(c.error);return c.data}s.d(t,{hi:function(){return r},xr:function(){return a}});let r={get:(e,t)=>n(e,{method:"GET",params:t}),post:(e,t)=>n(e,{method:"POST",body:t?JSON.stringify(t):void 0}),put:(e,t)=>n(e,{method:"PUT",body:t?JSON.stringify(t):void 0}),patch:(e,t)=>n(e,{method:"PATCH",body:t?JSON.stringify(t):void 0}),delete:e=>n(e,{method:"DELETE"})}},4508:function(e,t,s){"use strict";s.d(t,{$Q:function(){return o},Jn:function(){return d},Ox:function(){return l},T4:function(){return i},cn:function(){return r},p6:function(){return c}});var a=s(1994),n=s(3335);function r(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,n.m6)((0,a.W)(t))}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"EUR",s="string"==typeof e?parseFloat(e):e;return new Intl.NumberFormat("it-IT",{style:"currency",currency:t}).format(s)}function o(e,t){return e<=0||t>=e?0:Math.round((e-t)/e*100)}function l(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/images/placeholder.jpg";return e?"string"==typeof e?e:e.url||e.src||t:t}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{day:"numeric",month:"long",year:"numeric"},s="string"==typeof e?new Date(e):e;return new Intl.DateTimeFormat("it-IT",t).format(s)}},401:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},2451:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},407:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},6337:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},340:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]])},2369:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},8717:function(e,t,s){"use strict";s.d(t,{t:function(){return i}});var a=s(9625),n=s(6885),r=s(9116);let i=(0,a.Ue)()((0,n.tJ)((e,t)=>({customer:null,token:null,loading:!1,error:null,login:async(t,s)=>{e({loading:!0,error:null});try{let a=await r.hi.post("/shop/auth/login",{email:t,password:s});localStorage.setItem("auth_token",a.token),e({customer:a.customer,token:a.token,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},register:async t=>{e({loading:!0,error:null});try{let s=await r.hi.post("/shop/auth/register",t);localStorage.setItem("auth_token",s.token),e({customer:s.customer,token:s.token,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},logout:()=>{localStorage.removeItem("auth_token"),e({customer:null,token:null,error:null})},fetchProfile:async()=>{e({loading:!0,error:null});try{let t=await r.hi.get("/shop/auth/me");e({customer:t,loading:!1})}catch(s){t().logout(),e({error:s.message,loading:!1})}},updateProfile:async t=>{e({loading:!0,error:null});try{let s=await r.hi.patch("/shop/auth/profile",t);e({customer:s,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},forgotPassword:async t=>{e({loading:!0,error:null});try{await r.hi.post("/shop/auth/forgot-password",{email:t}),e({loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},resetPassword:async(t,s)=>{e({loading:!0,error:null});try{await r.hi.post("/shop/auth/reset-password",{token:t,password:s}),e({loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},isAuthenticated:()=>!!t().token&&!!t().customer,fullName:()=>{let e=t().customer;return e?"".concat(e.firstName||""," ").concat(e.lastName||"").trim():""}}),{name:"auth-storage",partialize:e=>({token:e.token,customer:e.customer}),onRehydrateStorage:()=>e=>{(null==e?void 0:e.token)&&localStorage.setItem("auth_token",e.token)}}))},3947:function(e,t,s){"use strict";s.d(t,{x:function(){return o}});var a=s(9625),n=s(6885),r=s(9116),i=s(4508);let o=(0,a.Ue)()((0,n.tJ)((e,t)=>({cart:null,loading:!1,error:null,sessionId:null,isDrawerOpen:!1,initSession:()=>{let s=t().sessionId;s||e({sessionId:s=(0,i.Ox)()}),(0,r.xr)(s)},fetchCart:async()=>{e({loading:!0,error:null});try{t().initSession();let s=await r.hi.get("/shop/cart");e({cart:s,loading:!1})}catch(t){e({error:t.message,loading:!1})}},addItem:async(s,a,n)=>{e({loading:!0,error:null});try{t().initSession();let i=await r.hi.post("/shop/cart/items",{productId:s,quantity:a,variantId:n});e({cart:i,loading:!1,isDrawerOpen:!0})}catch(t){throw e({error:t.message,loading:!1}),t}},updateQuantity:async(t,s)=>{e({loading:!0,error:null});try{let a=await r.hi.patch("/shop/cart/items/".concat(t),{quantity:s});e({cart:a,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},removeItem:async t=>{e({loading:!0,error:null});try{let s=await r.hi.delete("/shop/cart/items/".concat(t));e({cart:s,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},clearCart:async()=>{e({loading:!0,error:null});try{await r.hi.delete("/shop/cart"),e({cart:null,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},applyCoupon:async t=>{e({loading:!0,error:null});try{let s=await r.hi.post("/shop/cart/coupon",{code:t});e({cart:s,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},removeCoupon:async()=>{e({loading:!0,error:null});try{let t=await r.hi.delete("/shop/cart/coupon");e({cart:t,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},setShippingAddress:async t=>{e({loading:!0,error:null});try{let s=await r.hi.put("/shop/cart/shipping-address",t);e({cart:s,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},setShippingMethod:async t=>{e({loading:!0,error:null});try{let s=await r.hi.put("/shop/cart/shipping-method",{methodId:t});e({cart:s,loading:!1})}catch(t){throw e({error:t.message,loading:!1}),t}},openDrawer:()=>e({isDrawerOpen:!0}),closeDrawer:()=>e({isDrawerOpen:!1}),toggleDrawer:()=>e(e=>({isDrawerOpen:!e.isDrawerOpen})),itemCount:()=>{let e=t().cart;return(null==e?void 0:e.items)?e.items.reduce((e,t)=>e+t.quantity,0):0},subtotal:()=>{var e;let s=t().cart;return null!==(e=null==s?void 0:s.subtotal)&&void 0!==e?e:0},total:()=>{var e;let s=t().cart;return null!==(e=null==s?void 0:s.total)&&void 0!==e?e:0},isEmpty:()=>{let e=t().cart;return!(null==e?void 0:e.items)||0===e.items.length}}),{name:"cart-storage",partialize:e=>({sessionId:e.sessionId})}))},8614:function(e,t,s){"use strict";s.d(t,{M:function(){return f}});var a=s(7437),n=s(2265),r=s(8881),i=s(3576),o=s(4252),l=s(5750);class d extends n.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function c(e){let{children:t,isPresent:s}=e,r=(0,n.useId)(),i=(0,n.useRef)(null),o=(0,n.useRef)({width:0,height:0,top:0,left:0}),{nonce:c}=(0,n.useContext)(l._);return(0,n.useInsertionEffect)(()=>{let{width:e,height:t,top:a,left:n}=o.current;if(s||!i.current||!e||!t)return;i.current.dataset.motionPopId=r;let l=document.createElement("style");return c&&(l.nonce=c),document.head.appendChild(l),l.sheet&&l.sheet.insertRule('\n          [data-motion-pop-id="'.concat(r,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            top: ").concat(a,"px !important;\n            left: ").concat(n,"px !important;\n          }\n        ")),()=>{document.head.removeChild(l)}},[s]),(0,a.jsx)(d,{isPresent:s,childRef:i,sizeRef:o,children:n.cloneElement(t,{ref:i})})}let u=e=>{let{children:t,initial:s,isPresent:r,onExitComplete:l,custom:d,presenceAffectsLayout:u,mode:h}=e,p=(0,i.h)(m),x=(0,n.useId)(),g=(0,n.useCallback)(e=>{for(let t of(p.set(e,!0),p.values()))if(!t)return;l&&l()},[p,l]),f=(0,n.useMemo)(()=>({id:x,initial:s,isPresent:r,custom:d,onExitComplete:g,register:e=>(p.set(e,!1),()=>p.delete(e))}),u?[Math.random(),g]:[r,g]);return(0,n.useMemo)(()=>{p.forEach((e,t)=>p.set(t,!1))},[r]),n.useEffect(()=>{r||p.size||!l||l()},[r]),"popLayout"===h&&(t=(0,a.jsx)(c,{isPresent:r,children:t})),(0,a.jsx)(o.O.Provider,{value:f,children:t})};function m(){return new Map}var h=s(9637);let p=e=>e.key||"";function x(e){let t=[];return n.Children.forEach(e,e=>{(0,n.isValidElement)(e)&&t.push(e)}),t}var g=s(1534);let f=e=>{let{children:t,custom:s,initial:o=!0,onExitComplete:l,presenceAffectsLayout:d=!0,mode:c="sync",propagate:m=!1}=e,[f,y]=(0,h.oO)(m),b=(0,n.useMemo)(()=>x(t),[t]),j=m&&!f?[]:b.map(p),v=(0,n.useRef)(!0),w=(0,n.useRef)(b),N=(0,i.h)(()=>new Map),[k,C]=(0,n.useState)(b),[S,I]=(0,n.useState)(b);(0,g.L)(()=>{v.current=!1,w.current=b;for(let e=0;e<S.length;e++){let t=p(S[e]);j.includes(t)?N.delete(t):!0!==N.get(t)&&N.set(t,!1)}},[S,j.length,j.join("-")]);let M=[];if(b!==k){let e=[...b];for(let t=0;t<S.length;t++){let s=S[t],a=p(s);j.includes(a)||(e.splice(t,0,s),M.push(s))}"wait"===c&&M.length&&(e=M),I(x(e)),C(b);return}let{forceRender:P}=(0,n.useContext)(r.p);return(0,a.jsx)(a.Fragment,{children:S.map(e=>{let t=p(e),n=(!m||!!f)&&(b===S||j.includes(t));return(0,a.jsx)(u,{isPresent:n,initial:(!v.current||!!o)&&void 0,custom:n?void 0:s,presenceAffectsLayout:d,mode:c,onExitComplete:n?void 0:()=>{if(!N.has(t))return;N.set(t,!0);let e=!0;N.forEach(t=>{t||(e=!1)}),e&&(null==P||P(),I(w.current),m&&(null==y||y()),l&&l())},children:e},t)})})}}},function(e){e.O(0,[972,230,312,883,971,117,744],function(){return e(e.s=4825)}),_N_E=e.O()}]);